低版本less使用calc问题
https://stackoverflow.com/questions/11972084/how-to-prevent-less-from-trying-to-compile-css-calc-properties

https://juejin.cn/post/7167309383805304868#heading-1
https://juejin.cn/post/6939708814555873311#heading-5

浏览器渲染页面的过程通常包括以下几个步骤：

1.  解析HTML：浏览器通过解析HTML文档来构建文档对象模型（DOM），DOM是一个树形结构，表示文档的结构和内容。

2.  构建CSSOM：浏览器通过解析CSS文档来构建CSS对象模型（CSSOM），CSSOM是一个树形结构，表示文档的样式和布局。
    
3.  创建渲染树：浏览器将DOM和CSSOM合并为渲染树，渲染树只包含需要显示的内容，如文本、图像和表单元素等。渲染树的每个节点都对应着一个可见的元素，并包含其对应的样式信息。
    
4.  布局：浏览器确定渲染树中每个元素在屏幕上的位置和大小。这个过程称为布局（也称为回流）。
    
5.  绘制：浏览器将渲染树上的元素绘制到屏幕上。这个过程称为绘制。
    
6.  合成：浏览器将绘制好的元素合成为一张页面。如果页面中有动画或滚动，浏览器会重复执行以上过程，以确保页面的平滑渲染。

```lua
     +---------------------------+
     |   HTML 解析为 DOM 树      |
     |      & JS 执行            |
     +---------------------------+
                             |
                             |
     +---------------------------+
     |   CSS 解析为 CSSOM 树     |
     +---------------------------+
                             |
                             |
     +---------------------------+
     |   合并 DOM 和 CSSOM 生成   |
     |   渲染树                 |
     +---------------------------+
                             |
                             |
     +---------------------------+
     |   计算每个节点的布局信息   |
     |   (回流)                 |
     +---------------------------+
                             |
                             |
     +---------------------------+
     |   绘制每个节点的内容      |
     |   (重绘)                 |
     +---------------------------+
                             |
                             |
     +---------------------------+
     |   合成所有图层生成最终   |
     |   的页面                |
     +---------------------------+

```
这个流程图显示了浏览器渲染页面的过程，其中HTML和JavaScript被解析为DOM树，CSS被解析为CSSOM树，然后这两个树被合并为一个渲染树。接下来，浏览器计算每个节点的布局信息并绘制节点的内容，最终所有图层被合成为最终的页面。这个过程可以反复进行，以支持动画或滚动等交互式操作。

第一步是将HTML文档解析为DOM树的过程，这个过程通常包括以下几个步骤：

1.  标记化：浏览器将HTML文档解析为一系列标记（如开始标记、结束标记、注释等），每个标记都表示文档中的一个元素或文本节点。
    
2.  构建节点：浏览器根据标记创建节点对象，并设置节点的属性（如id、class、style等）和子节点（如果有的话）。
    
3.  构建树：浏览器将节点对象按照其嵌套关系构建为DOM树，DOM树是一个树形结构，根节点是文档对象（document），每个节点都有其父节点、子节点和兄弟节点。
    
4.  解析JavaScript：如果HTML文档包含JavaScript代码，浏览器会在构建DOM树的过程中执行这些代码，以修改DOM树或执行其他操作。
    

DOM树表示了HTML文档的结构和内容，它是浏览器渲染页面的基础。通过DOM树，浏览器可以获取文档的内容和结构，并将其用于页面的布局和渲染。同时，JavaScript代码可以通过DOM树来操作页面的元素和样式，以实现交互和动态效果

第二步是将CSS文档解析为CSSOM树的过程，这个过程通常包括以下几个步骤：

1.  词法分析：浏览器将CSS文档分解为一系列词法单元（如选择器、属性、值等），并将其转换为抽象语法树（AST）。
    
2.  解析样式规则：浏览器将CSS样式规则解析为规则集合，每个规则包含一个选择器和一个样式块，样式块中包含一组属性和对应的值。
    
3.  解析选择器：浏览器将选择器解析为一个选择器链，选择器链由一系列选择器组成，每个选择器描述了文档中的一个元素。
    
4.  计算样式：浏览器将CSS样式规则应用到DOM树上，计算每个元素的最终样式值。这个过程包括继承、层叠和优先级等处理。
    
5.  生成CSSOM树：浏览器将每个元素的最终样式值保存在一个CSS对象模型（CSSOM）节点中，CSSOM树是一个树形结构，表示文档的样式和布局。
    

CSSOM树表示了文档的样式和布局信息，它是浏览器渲染页面的关键。通过CSSOM树，浏览器可以获取每个元素的最终样式值，并将其用于页面的布局和渲染。同时，JavaScript代码可以通过CSSOM树来操作样式和布局，以实现交互和动态效果。

第三步是将DOM树和CSSOM树合并为渲染树的过程，这个过程通常包括以下几个步骤：

1.  确定可见节点：浏览器遍历DOM树和CSSOM树，过滤出所有需要显示的节点，并将它们组成一个新的树形结构——渲染树。
    
2.  计算布局：浏览器遍历渲染树，计算每个节点的位置和大小，并确定它们在屏幕上的确切位置。
    
3.  绘制：浏览器将渲染树中的节点按照其在屏幕上的位置和大小进行绘制，包括填充、边框、背景、阴影等效果。
    

渲染树是一个只包含需要显示的元素的树形结构，它是浏览器渲染页面的最终结果。渲染树中的每个节点都已经确定了其样式和布局信息，并且已经被转换为屏幕上的像素。通过渲染树，浏览器可以快速地将页面显示在屏幕上，同时保证页面的正确性和完整性。

非常抱歉，我理解错误。第四步是布局（Layout），也称为回流（Reflow），是指浏览器根据DOM树和样式计算出每个元素的大小、位置等信息的过程。

具体来说，布局通常包括以下几个步骤：

1.  计算盒模型：浏览器会根据元素的样式计算出每个盒模型的大小和位置信息，包括元素的宽度、高度、内边距、外边距等。
    
2.  计算位置：浏览器会计算出每个元素的精确位置信息，并将其放置在正确的位置上。这个过程通常需要考虑元素的定位、浮动、清除等属性，以及文档流中的其他元素。
    
3.  确定大小：浏览器会根据元素的内容和样式计算出每个元素的最终大小，并将其应用到DOM树中。这个过程通常需要考虑元素的宽度、高度、最小宽度、最大宽度等属性，以及文档流中的其他元素。
    
4.  创建布局树：最后，浏览器会将计算好的元素信息组织成一棵布局树，用于后续的绘制和渲染。
    

布局是页面渲染中非常重要的一个步骤，因为它直接影响页面的性能和响应速度。如果页面中包含大量的元素和复杂的布局，布局的计算量可能会非常大，导致页面的渲染速度变慢。因此，开发者需要注意优化布局，避免过度嵌套、过度使用浮动和定位等布局方式，以提高页面的性能和响应速度。

第四步是将渲染树的节点绘制在屏幕上的过程，通常包括以下几个步骤：

1.  栅格化：浏览器将渲染树中的每个节点转换为位图，也就是将每个节点绘制到一个独立的图像缓冲区中。
    
2.  合成：浏览器将所有位图合成为一张完整的图像，并将其绘制到屏幕上。这个过程中，浏览器需要考虑每个节点的绘制顺序、透明度、混合模式等因素。
    
3.  显示：浏览器将图像显示在屏幕上，并响应用户的交互事件。
    

这个过程通常是由图形处理单元（GPU）执行的，因为GPU可以快速地处理大量的位图和合成操作。同时，浏览器还会对渲染树进行优化，例如利用GPU硬件加速、异步绘制、缓存等技术，以提高页面的性能和响应速度。

在这个过程中，浏览器还需要考虑一些其他的因素，例如字体渲染、颜色管理、分辨率适配等。这些因素对于不同的设备和浏览器可能会有所不同，因此，开发者需要考虑这些因素，并进行相应的调整和优化。

第六步是合成（Compositing），也称为合成层（Compositing Layers），是指将多个绘制对象按照正确的顺序合成为最终的像素信息的过程。

在渲染页面时，浏览器会创建多个图层（Layers），每个图层都包含一个或多个绘制对象。图层可以理解为独立的平面，它们之间可以叠加、透明等，从而形成最终的页面效果。

合成的过程主要包括以下几个步骤：

1.  图层合并：浏览器会将多个图层按照正确的顺序合并到一起，形成最终的绘制对象。合并的顺序通常是按照图层的层次结构、位置等属性决定的。
    
2.  剪裁：浏览器会将最终的绘制对象剪裁到可视区域内，去掉超出可视区域的部分。这个过程可以提高页面的渲染速度和性能。
    
3.  压缩：如果需要，浏览器会对最终的像素信息进行压缩，以减小传输和存储的数据量。
    
4.  显示：最后，浏览器会将压缩后的像素信息显示在屏幕上，呈现给用户。
    

需要注意的是，如果页面中包含大量的图层、透明度等效果，合成的计算量可能会非常大，导致页面的渲染速度变慢。因此，开发者需要注意优化合成，避免过度使用图层、透明度等效果，以提高页面的性能和响应速度。同时，开发者也可以通过一些技巧，如使用CSS 3D变换、硬件加速等，来优化页面的合成过程。